---
categories: algorithm
layout: post
---

- Table
{:toc}
# 边分治

边分治类似于点分治，区别在于点分治找的是重心点，而边分治找的是重心边。

树T的重心边是指这样一条边e，使得删除e后得到的两个连通块大小的最大值最小，我们记作$effect(e)$。

由于对于菊花图，任何边得到的连通分块的大小都是1和n-1，因此边分治不能得到很好的效果。我们可以插入一些假的顶点，使得每个顶点下只挂两条边（不包括与父亲相连的边）。

现在在已知树中每个顶点的度都不超过3的前提下，我们证明假如e是树T的重心，且T的大小为n，那么$effect(e)\leq \frac{2}{3}n$。实际上假设e是树T的重心，连接两个顶点u、v。不妨认u所在连通块的大小大于$\frac{2}{3}n$。考虑到u至多还能连接两条边，因此至少有一条边e'的另外一端所在连通块的大小能达到$\frac{1}{3}n$。e'是比e更好的重心。

边分治的优势在于边连接的一定是父子，因此可以将树分成两部分，包含根的记作R，不含根的记作B。而R中任意顶点x，与B中所有顶点的LCA是相同的，因此可以提前计算并用于后面的处理。

# LUOGU4565

**题意**

[https://www.luogu.org/problem/P4565](https://www.luogu.org/problem/P4565)

**题解**

首先用边分治将树1分为两块，包含根的记作R，不含根的记作B。给R中顶点上黑色，B中顶点上白色，之后根据树2建立虚树。

记一个顶点x在树中到树根的路径的总边权记作prefix(x)，记B中深度最浅的顶点为y。

那么黑色顶点a的点权为：weight(a)=prefix(a)-prefix(lca(a, y))

白色顶点b的点权为：weight(b)=prefix(b)

建立好虚树后，我们要找到虚树上距离最远的一对黑白点，其中虚树中a,b距离的定义为：$weight(a)+weight(b)-weight(lca(a,b))$。这个问题dfs就能解决了。

总的时间复杂度为$O(n(\log_2n)^2)$。