---
categories: mathematics
layout: post
---

- Table
{:toc}

# 正文

**卢卡斯定理：对于非负整数m和n和素数p，下面同余式成立：**


$$
{m \choose n}=\prod_{i=0}^{k}{m_i \choose n_i}
$$


**其中：**


$$
m=\sum_{i=0}^{k}m_ip^i\\
n=\sum_{i=0}^{k}n_ip^i
$$


**满足$0\leq m_i<p$且$0\leq n_i<p$。**

证明：

由于
$$
{p \choose n}=\frac{p(p-1)\ldots(p-n+1)}{n(n-1)\ldots1)}
$$
因此，只有当$n$为$1$或$p$时，上面二项式中有因子$p$。因此可以推出
$$
(1+X)^p=1+X^p(mod\phantom{1}p)
$$
利用数学归纳法可以容易得到下面的扩展：
$$
(1+X)^{p^i}=1+X^{p^i}(mod\phantom{1}p)
$$
之后我们利用这个扩展证明卢卡斯定理。
$$
\sum_{n=0}^m{m \choose n}X^n=(1+X)^m=(1+X)^{\sum_{i=0}^km_ip^i}=\prod_{i=0}^k((1+X)^{p^i})^{m_i}\\
=\prod_{i=0}^k(1+X^{p^i})^{m_i}=\prod_{i=0}^k\sum_{n_i=0}^{m_i}{m_i \choose n_i}X^{n_ip^i}=\prod_{i=0}^k\sum_{n_i=0}^{p-1}{m_i \choose n_i}X^{n_ip^i}\\
=\sum_{n=0}^m(\prod_{i=0}^k{m_i \choose n_i})X^n (mod \phantom{1} p)
$$




# 应用

卢卡斯定理可以用于快速计算${m \choose n}(mod \phantom{1} p)$，其中$m$可能特别大，而$p$是素数。如果$p$比较小，可以预先打表记录$1$到$p-1$每个值的阶乘和阶乘的逆元，从而实现$O(1)$时间复杂度内计算组合运算，预处理的时空复杂度均为$O(p)$。而计算每个组合运算，都只需要$O(\log_2m)$的时间复杂度。

如果$p$不是素数，但是假如$p$是若干个不同素数的乘积，那么可以将$p$分解为若干个不同的素数$p_1,p_2,\ldots,p_k$，且$p=\prod_{i=1}^kp_i$。之后我们分别利用卢卡斯定理分别计算${m \choose n}(mod \phantom{1} p_i)$，其中$i=1,2,\ldots,k$。由于$p_1,p_2,\ldots,p_k$彼此互质，因此利用中国余数定理，可以利用这些结果组合成${m \choose n}(mod \phantom{1} p)$。



# 参考文献

\[1\] [https://zh.wikipedia.org/wiki/%E5%8D%A2%E5%8D%A1%E6%96%AF%E5%AE%9A%E7%90%86](https://zh.wikipedia.org/wiki/%E5%8D%A2%E5%8D%A1%E6%96%AF%E5%AE%9A%E7%90%86)