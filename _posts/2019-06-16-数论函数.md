---
categories: algorithm
layout: post
---

- Table
{:toc}
# BZOJ2190

**题意**

[https://www.lydsy.com/JudgeOnline/problem.php?id=2190](https://www.lydsy.com/JudgeOnline/problem.php?id=2190)

**题解**

对于n，我们标记左下角左边为(0,0)，右上角坐标为(n-1,n-1)。

那么我们可以逐点统计，对于点(i,j)，其中i>0且j>0。若gcd(i,j)>1，则与(i/gcd(i,j),j/gcd(i,j))处于一条线上，因此我们可以仅仅统计这些互质的坐标对就可以防止重复统计问题。

但是总共有$n^2$个坐标，这有点多了，所以我们需要用别的方式进行加速。不说废话，直接列式子：


$$
\sum_{i=1}^n\sum_{j=1}^n[gcd(i,j)=1]\\
\Rightarrow \sum_{i=1}^n\sum_{j=1}^n\sum_{d|gcd(i,j)}\mu(d)\\
\Rightarrow \sum_{d=1}^n\,u(d)\sum_{d|i}\sum_{d|j}1\\
\Rightarrow \sum_{d=1}^n\,u(d)\sum_{i=1}^{\lfloor \frac{n}{d} \rfloor}\sum_{j=1}^{\lfloor \frac{n}{d} \rfloor}\\
\Rightarrow \sum_{d=1}^n\lfloor \frac{n}{d} \rfloor^2\,u(d)
$$


这里莫比乌斯函数可以用欧拉筛预先处理，总共循环n次，时间复杂度为$O(n)$。