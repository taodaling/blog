---
categories: algorithm
layout: post
---

- table
{:toc}

# 最小立方倍数问题

给定$n=10000$个数
$$
a_1,a_2,\ldots, a_n
$$
，每个数的范围是
$$
[1,10^{12}]
$$
，要求为每个数
$$
a_i
$$
计算其最小的立方倍数（即
$$
a_i|y^3
$$
）。

这里有一个
$$
O(10^{6}+n\cdot10^4)
$$
的解法。

对于任意数
$$
x\in [1,10^{12}]
$$
，要计算其最小立方倍数。记录Norm(x)表示x的没有立法因子的最大因子，记录Pair(x)表示Norm(x)的最小立法倍数。我们可以先找到所有x的素数因子
$$
p\in [1,10^{12/3}]
$$
。之后利用这些因子可以得到$Norm(x)$。问题在于如何计算$Pair(x)$呢。

考虑数
$$
Norm(x)
$$
除去所有小于
$$
10^{12/3}
$$
的素因子后，最后剩下的数$s$，数$s$可能有三种情况：

1. s是一个素数或1
2. s是两个不同的素数的乘积
3. s是某个素数的平方

对于第一和第二种情况，我们可以直接得出
$$
Pair(s)=s^2
$$
，而对于第三种情况，有
$$
Pair(s)=\sqrt{s}
$$
。

这样假如我们预先处理出所有不超过$10^{12/2}$的素数，并计算出他们的平方。那么我们可以在$O(10^{12/3})$时间复杂度内计算$Pair(x)$和$Norm(x)$。

我们记$Cubic(x)$表示x的最小立法倍数，那么可以得出：
$$
Cubia(x)=x\cdot Pair(x)
$$
。

这里的总的时间复杂度为$O(10^{6}+n\cdot10^4)$。

