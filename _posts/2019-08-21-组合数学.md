---
categories: math
layout: post
---

- Table
{:toc}
# Catlan数

## 理论

假设我们有n个1和m个-1，我们希望排列这n+m个数，并且要求排列$a_i$满足下面条件：

- 对于任意$0 \leq j \leq n+m$，都有$\sum_{i\leq j} a_i \geq -k$。

我们希望求出有多少种不同的排列满足条件。

首先如果$m > n+k$，那么有效排列数一定为0。下面仅考虑$m\leq n+k$的情况。

我们知道总共的排列数为$n+m \choose n$，因此只要减去不满足条件的排列数，就可以得到满足的排列数了。下面我们考虑怎么计算不满足条件的排列数。

对于某个不满足条件的排列$B=\[b_i\]$，一定能找到最小的下标$j$，使得$\sum_{i\leq j} a_i = -(k+1)$。我们将排列$B$的从第$j+1$个下标开始的值全部取相反值，即1改为-1，-1改为1。这样我们就得到了一个$m-1-k$个1和$n+1+k$个-1的排列。要还原，我们只需要找到最小的下标$j$，使得$\sum\_{i\leq j} a_i = -(k+1)$，将后面的元素取反就好了。这似乎暗示了$n$个1和$m$个-1的无效排列与$m-1-k$个1和$n+1+k$个-1的排列之间存在类似双射的关系。首先很明显从前者到后者一定是单射，即不同的输入对应不同的输出，同时由于$m-1-k$个1和$n+1+k$个-1的排列中必定能找到这样的$j$，使得前j个数的和为-(k+1)，因此映射是满射。

满射意味着$n$个1和$m$个-1的无效排列与$m-1-k$个1和$n+1+k$个-1的排列数目相同，即总有效排列数为：


$$
{n+m\choose n} -{n + m \choose n + 1 + k}
$$




## 例子1

Catlan数最简单的例子就是n个左括号和n个右括号能构成多少有效的括号序列了。



首先一个括号序列有效，当且仅当排列中所有前缀部分中，左括号数不少于右括号数。如果我们将左括号视作1，右括号视为-1，取$k=0$，那么就转换为Catlan数问题了。有效数为



$$
{2n\choose n} -{2n \choose n + 1}
$$
