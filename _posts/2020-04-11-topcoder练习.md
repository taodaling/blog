---
categories: algorithm
layout: post
---

- Table
{:toc}

# SRM782 PaintItBlack

**翻译**

给定一个拥有$n$个顶点$m$条边的无向连通图。你现在位于顶点$1$。所有顶点的颜色初始时都是白色，当你沿着边$(u,v)$从$u$移动另外一个顶点$v$的时候，$v$的颜色会改变（从黑色变成白色，或从白色变成黑色）。现在要求找出一条从顶点$1$出发最后回到顶点$1$的回路（回路中同一条边可以走多次），要求回路的长度不超过$5n$，且沿着这条回路移动后，最终所有顶点的颜色都变成了黑色。输出这样一条回路或者报告无解。

**题解**

挺不错的题目。

问题实际上要求找到一条回路。如果仅考虑回路中的单向边，每个顶点的入度都是奇数，且回路是欧拉回路，有向图欧拉回路有解当且仅当每个顶点入度和出度相同，且图连通。

由于是无向图，那么我们可以沿着某条路径$P$从$1$移动到$x$，之后在原路返回到$1$。这样也是一条回路，注意到走过这样一条路径后，除了$1$和$x$的颜色改变，其余顶点的颜色都保持不变。同时由于图是连通的，因此我们可以利用这种方法，对于任意顶点$2\leq i\leq n$，都找到一条从$1$到$i$的路径，并原路返回，这样除了$1$外其余所有顶点的颜色都变成了黑色，且这样移动还能得到一条回路。

现在我们来讨论$1$的最终颜色，由于$1$的入度最终为$n-1$，因此如果$n$是偶数，那么$1$最终是黑色。这样就大功告成了。

现在来讨论$n$是奇数的情况。我们发现其实之所以$n$是奇数的情况下上面的策略$1$一定是白色，因为没走一趟，都有偶数个顶点的颜色变更，因此无论走多少趟，至少会有一个顶点的颜色保持白色。但是如果此时如果图中有长度为奇数的简单环，那么我们可以通过走这条环改变图中白色顶点数目的奇偶性，这样就有解了。

下面我们证明在其余情况下，一定无解。所谓的其余情况实际上就是$n$是奇数且没有奇数环，这时候我们会得到一个顶点数为奇数的二分图$(L,R)$，其中$1 \in L$，我们发现回路的终点一定在$L$，但是回到$L$集合的时候，路径的长度一定为偶数，换句话说，只有偶数个顶点的颜色变更，而$n$奇数，因此不可能所有顶点同时颜色为黑色。

至于题目要求回路长度不超过$5n$，我们可以生成任意一颗生成树，之后我们假如我们考虑连接父亲$f$和孩子$c$边$(f,c)$，注意到我们会通过$(f,c)$从$f$到$c$的次数和从$c$到$f$次数是一样的，对于$c$子树内的每个顶点$v$，从$f$到$v$都要经过一次$(f,c)$，因此经过$(f,c)$从$f$到$c$的次数等于$size(c)$。但是如果$size(c)>2$，那么说明我们从$f$到$c$和从$c$到$f$的次数超过了$2$，我们可以各减去$2$，这样不会改变任何顶点入度的奇偶性，且每个顶点的入度和出度一致，且不破坏连通性。因此每条树边的每个方向都最多在回路出现两次，这里总共有$4n-4$条边。之后可能还需要加入一条奇数长度的简单环，长度最多为$n$，因此我们要找的回路长度最多为$5n-4$，是满足条件的。

算法的过程，我们可以先将最终会出现在回路中的有向边提取，之后在找欧拉回路，可以用Hierholzer算法解决。

# SRM783 CardboardBoxes

**翻译**

要求求公式$2(x^2+xy+xz+yz)=S$的正整数解数目，其中$S$是给定整数，$x,y,z$是要赋值的未知数，且$y\geq x$，$S\leq 10^{15}$

**题解**

首先有解的前提是$S$是偶数，我们将公式先进行化简：

$$
x^2+xy+xz+yz=\frac{S}{2}
$$

之后最重要的就是左部公式可以化简：

$$
(x+y)(x+z)=\frac{S}{2}
$$

由于$(x+y)\|\frac{S}{2}$。因此我们可以枚举所有$\frac{S}{2}$的因子。考虑$x+y=a$，那么$x+z=\frac{S}{2a}$。

这时候还有三个约束条件，一个是$y\geq x$，另外一个是$x\geq 1$，最后还有$z\geq 1$。将$y$和$x$都用$x$代替可以得出：

$$
\left\{
\begin{array}{ccc}
x &\geq &1\\
-2x+a&\geq& 0\\
-x+\frac{S}{2a} &\geq& 0 
\end{array}
\right.
$$

最后可以得出$x$的取值范围。