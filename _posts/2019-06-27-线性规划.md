---
categories: algorithm
layout: post
---

- Table
{:toc}

# 线性规划原理

线性规划用于在某个约束条件下，优化某个线性函数。其标准式如下：

$$
\left.
\begin{array}{lc}
 \max & c^Tx\\
 s.t. & Ax=b\\
& x\geq 0
\end{array}
\right.
$$

其中所有涉及的数值都是实数，$A\in \mathbb{R}^{m\times n},c,x\in \mathbb{R}^n,b\in \mathbb{R}^m$。定义$P=\{x\mid Ax=b\land x\geq 0\}$，即所有可行解的集合。

我们下面的讨论均认为$A$的行向量是线性无关的，即$m\leq n$。

## 转换为标准公式

如果我们最终要求解的是$\min\phantom{}c^Tx$，那么等价于求解$\max\phantom{}-c^Tx$。

如果约束条件形式为$\sum_j a_{ij}x_j \leq b_i$，我们可以增加一个松弛变量$s_i$，满足$s_i\geq 0$，并将约束公式替换为$\sum_j a_{ij}x_j+s_i=b_i$。

如果约束公式形式为$\sum_j a_{ij}x_j \geq b_i$，那么我们可以记$a'_{ij}=-a_{ij}$，并将约束公式替换为$$$\sum_j a'_{ij}x_j \leq -b_i$。

如果约束条件为$\sum_j a_{ij}x_j = b_i$，可以拆分成两个约束条件$\sum_j a_{ij}x_j \leq b_i$以及$\sum_j a_{ij}x_j \geq b_i$。

如果某个变量$x_i$没有约束，那么可以替换为$x_i=x_i'-x''_i$，其中$x'_i,x''_i\geq 0$。

## 线性规划几何解释

所有满足线性规划的$m+n$个约束条件的向量集合$P$，我们可以将其理解为$R^{n-m}$维空间中用半平面切出的凸包。凸包的特点就是$P$中任意两点$a,b$指定的直线上的所有点也是$P$中的点。

**命题1：在凸包顶点处可以取得线性规划的最优解**

假设我们在凸包非顶点处$x$上取到了最优解。那么一定存在某个非$0$向量$d$，满足$x\pm d\in P$，即$A(x\pm d)=b\Rightarrow Ad=0$。如果$x_i=0$，那么一定有$d_i=0$。且由于$x$上是最优解，我们可以推出$c^Td=0$。

由于$d$非0，因此一定存在某个$i$，满足$x_i,d_i>0$（否则我们取$-d$即可），我们选择一个合适的$\lambda$，满足$x_i-\lambda d_i=0$,即我们从$x$转移到$x'=x-\lambda d$处，且$x'\geq 0$，这时候依旧能取到最优解，但是一个新的维度被赋值为$0$。

重复上面这个过程，直到找到某个顶点为止，很显然流程必定会终止。

**命题2：对于任意$x\in P$，定义$B=\{i\mid x_i>0\}$。那么$x$是凸包上的某个顶点，当且仅当$A_B$的列向量线性无关，这里$A_B$表示由$B$中下标指定的$A$中的列组成的子阵。**

比如$x=\left[\begin{array}{c} 2\\0\\1\\0 \end{array}\right]$，$A=\left[\begin{array}{cccc} 2&1&3&0\\7&3&2&1\\0&0&0&5 \end{array}\right]$，那么$B=\{1,3\}$，$A_B=\left[\begin{array}{cc} 2&3\\7&2\\0&0 \end{array}\right]$。由于$A_B$的列向量线性无关，因此$x$是凸包上的某个顶点。

这里给一下证明：

先证明充分性。假设$x$不是顶点，那么存在某个$d$，满足$x\pm d\in P$，即$Ad=0$，且$x_i=0\Rightarrow d_i=0$。而$Ad=0$可以推出$A_Bd_B=0$，其中$d_B\neq 0$，这与$A_B$的列线性无关相悖，因此假设不成立。

再证明必要性。如果$A_B$线性无关，那么一定存在某个向量$d_B$满足$A_Bd_B=0$，我们用$0$填充$d$的其它维度，将其扩展为长度为$n$的向量，这样一定有$Ad=0$，即$x\pm d\in P$，即$x$不是顶点。

**命题3：$x$是一个顶点，当且仅当存在存在某个$C\subseteq N=\{1,\ldots,n\}$，满足$\|C\|=m$，且$A_C$是非奇异矩阵，$x_C=A_C^{-1}b_C\geq 0$，$x_{N/C}=0$**。

证明：

必要性：由于行向量线性无关，因此如果$x$是顶点，我们可以将$A_B$扩充为$A_C$。

充分性：对应的如果我们找到这样一个$C$，由于$Ax=b$，且$x\geq 0$，因此$x\in P$，假如$x$不是顶点，就能找到这样的$d$，满足满足$x\pm d\in P$。当然根据$d_C$非0且$A_Cd_C=0$，可以推出$A_C$的为奇异矩阵。

现在我们就得到了一个获取线性规划最优解的简单算法，遍历所有凸包上的顶点，并判断其是否是最优解。但是不幸的是，虽然我们可以$O(m^3)$时间复杂度内判断矩阵是否奇异，但是$C$共有${n\choose m}$种可能的选择，而这是指数级别的。

# 整数规划



# 参考资料

- [https://www.cs.princeton.edu/~wayne/kleinberg-tardos/pdf/LinearProgrammingI.pdf](https://www.cs.princeton.edu/~wayne/kleinberg-tardos/pdf/LinearProgrammingI.pdf)
- [Totally Unimodular Matrix](https://oxer11.github.io/blog/Totally-Unimodular-Matrix/)