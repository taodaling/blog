---
categories: algorithm
layout: post
---

- Table
{:toc}
# BZOJ2330

**题意**

[https://www.lydsy.com/JudgeOnline/problem.php?id=2330](https://www.lydsy.com/JudgeOnline/problem.php?id=2330)

**题解**

建立差分约束系统求解。这里需要注意的是，我们要求至少准备多少个糖果，即要最小化糖果总数。而我们通过差分约束系统求解得到的是最大化。因此我们需要建立辅助变量。原始变量记为$a_i$，而辅助变量记为$b_i$，使得$b_i=-a_i$。之后我们要建立的是$b_i$的差分约束系统，求得最优解后取反就是需要的最少糖果数。

为了保证每个$b_i$都一定要小于等于0，我们需要建立一个超级源点，并加入约束条件$b_i-s\leq 0$。之后搜索以s为源点的最短路。但是实际上，理解s真正起到的作用，由于s只有出边没有入边，我们可以去除s，而将所有其他结点的初始距离设为0即可。

还有需要注意的是数据有毒，在负环的时候spfa会被卡，需要使用深度优先版本的spfa。