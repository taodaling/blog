---
categories: algorithm
layout: post
---

- Table
{:toc}

# 最大权子矩形问题

**给定一个$n\times m$网格，每个网格上有一个整数，要求选择一个非空子矩形，要求子矩形中包含的数的总和最大。**

我们可以暴力枚举子矩形的上下边界，现在的问题就是一个序列，要求求一段子序列使得总和最大，这是一个经典问题，可以$O(n)$求解。

整体时间复杂度为$O(n^2m)$（我们可以旋转整个网格得到时间复杂度$O(m^2n)$)。

# 最大面积子矩形问题

**给定一个$n\times m$网格，每个网格上写着数字0或1。要求选择一个非空子矩形，满足子矩形中只包含数字0且矩形面积最大。**

如果我们给0替换为1,1替换为负无穷，问题就变成了最大权子矩形问题，我们就有了$O(n^2m)$的算法。

我们可以暴力枚举子矩形的上边界$i$，并且对每个$j=1,\ldots,m$，记$f_i(j)$表示$(i,j)$上方的第一个1出现的纵坐标（如果不出现记做$n+1$)。我们知道一个最大面积子矩形必定不能再向上，左，右继续扩大，不能向上扩大是因为上方有1。我们分别考虑这个1出现的位置，其可能为$(f_i(j),j)$，对于给定1的位置，我们可以容易确定左右边界，左右边界可以通过递增队列来实现，因此对于给定$i$，我们可以$O(m)$算出相关的所有可能结果。

总的时间复杂度为$O(nm)$。

提供一道[题目](https://cses.fi/problemset/task/1147/)。

