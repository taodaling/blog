---
categories: problems
layout: post
---

- Table
{:toc}

# BZOJ3098

**题意**

[https://www.lydsy.com/JudgeOnline/problem.php?id=3098](https://www.lydsy.com/JudgeOnline/problem.php?id=3098)

**题解**

随机生成长度为n的字符串。要求计算有多少种不同的长度为m的字符串。设Hash时模去的素数为p。

对于两个不同的字符串，发生误判的概率应该为$\frac{m}{p}$，总共有$n-m$种不同的字符串。而根据生日悖论知道，需要$\sqrt{p/m}$种字符串才能保证发生至少一次误判。


$$
\sqrt{\frac{p}{m}} < n\Rightarrow p<mn^2
$$


我们知道增大m的价值不大，而减少m可以有效的提高$n^2$，因此让m尽可能小，只要保证哈希值足够超出p就可以了。

# POJ2774

**题意**

[http://poj.org/problem?id=2774](http://poj.org/problem?id=2774)

**题解**

神级模板题。还有更裸的吗，后缀数组、后缀自动机、后缀树啥的，都来一波。

# BZOJ1031

**题意**

[https://www.lydsy.com/JudgeOnline/problem.php?id=1031](https://www.lydsy.com/JudgeOnline/problem.php?id=1031)

**题解**

很显然，问题要我们对所有可能的序列进行排序。想到对子串进行排序，应该能想到后缀数组吧。但是问题中是对序列进行排序，而非后缀，我们可以将输入字符串s变为s+s。之后如果两个后缀的第一个字符下标均小于\|s\|，那么此时二者的顺序取决于第一个不同的字符，如果这个字符离第一个字符距离超过\|s\|，那么二者顺序不影响结果，否则这个字符将决定二者的正确顺序。

之后直接用height数组，搞搞最长公共前缀就可以了。

# BZOJ1014

**题意**

[https://www.lydsy.com/JudgeOnline/problem.php?id=1014](https://www.lydsy.com/JudgeOnline/problem.php?id=1014)

**题解**

判断最长公共前缀，可以用二分加哈希的方法快速计算。但是我们发现字符串是会改变的，因此不能提前算哈希值。我们可以将字符串放在平衡树上维护，pushUp时重新计算哈希值，这样不仅支持修改新增操作，而且每次查询某段区间的哈希值的时间复杂度都被优化到了$O(\log_2n)$。