---
categories: algorithm
layout: post
---

- table
{:toc}
# 拉格朗日定理

拉格朗日定理：对于任意有限群$G$以及其某个子群$H$，都有
$$
|G|
$$
能被
$$
|H|
$$
整除。

证明：

当$G=H$时，定理显然成立，下面考虑$G\neq H$，此时有$\|H\|<\|G\|$。

考虑$H$在$G$中的补集中的任意元素$x_1$，我们构建$H$的左陪集：

$$
x_1H=\{x_1*h|h\in H\}
$$
。

下面我们证明$H$的这些左陪集与$H$的交集为空，假设存在交集，即：

$$
h_i=x_1*h_j
$$
，那么我们可以直接推出：
$$
x_1=h_i*h_j^{-1}\in H
$$
，而这与$x_1$不属于$H$的前提相悖，因此证明完成。

如果$H$与$xH$的并集不等于$G$，那么就存在额外的元素$x_2$，落在$H$和$xH$之外。于是我们继续构建$H$的左陪集$x_2H$。

重复这个流程，直到得到左陪集与$H$的并集等于$G$为止。假设这时候我们得到的左陪集为$x_1H,x_2H,\ldots, x_kH$。

下面我们证明这些左陪集也是互不相交的，假设$x_iH$与$x_jH$（$i < j$）交集非空，那么有：
$$
x_ih_i=x_jh_j\Rightarrow x_j=x_ih_ih_j^{- 1}\Rightarrow x_j\in x_iH
$$

，这与我们之前的
$$
x_j \notin x_iH
$$
前提相悖，因此证明成立。

可以发现这k个左陪集与$H$都拥有$\|H\|$个元素，且互不相交，且并为$G$。因此可以得出：
$$
(k+1)|H|=|G|
$$
，因此$\|H\|$能够整除$\|G\|$，命题成立。

# $rank(A^TA)=rank(A)$

对于任意$m\times n$矩阵$A$,都有$rank(A^TA)=rank(A)$。

证明：

考虑对于$A^TA$零空间中的向量$x$，有

$$
A^TAx=0\\
\Rightarrow x^TA^TAx=0\\
\Rightarrow (Ax)^T(Ax)=0\\
\Rightarrow \|Ax\|^2=0\\
\Rightarrow Ax=0
$$

因此，$A^TA$和$A$具有相同的零空间，$A$的零空间的秩为$rank(N(A))$，那么$A^TA$的秩为$rank(A^TA)=m-rank(N(A))=rank(A)$。

# $A^TA$是非奇异矩阵当且仅当A的列向量线性无关

$A^TA$是非奇异矩阵，当且仅当A的列向量线性无关。

证明:

由于$m=rank(A^TA)=rank(A)$，因此当$A$的列向量线性无关。

# AB与BA特征值相同

**对于两个方阵$A$，$B$，我们始终有$AB$和$BA$的特征值相同。**

证明：

设$\lambda$是$AB$的任意特征值，$x$是$AB$的特征值为$\lambda$的特征向量。

$$
ABx=\lambda x\\
\Rightarrow BABx=\lambda Bx\\
\Rightarrow (BA)(Bx)=\lambda (Bx)
$$

这意味着$\lambda$同时也是$BA$的特征值，而$Bx$是$BA$的特征值为$\lambda$的特征向量。

# 实对称矩阵特征向量两两正交

考虑对称矩阵$A$，以及其某个特征向量$x$和$y$。有

$$
Ax=\lambda_1x\\
Ay=\lambda_2y
$$

将第一个式子的左右两端都乘上$y^T$，可以得到：

$$
y^TAx=\lambda_1y^Tx\\
\Rightarrow \lambda_2 y^Tx=\lambda_1 y^Tx
$$

这意味着，$\lambda_1\neq \lambda_2\Rightarrow y^Tx=0$。

# $n\times n$实对称矩阵拥有$n$个正交特征向量

证明：

待补充。

# 奇异值分解存在性证明

奇异值分解是指对于任意$n\times m$矩阵$A$，我们都能将其分解为如下形式$A=U\Sigma V^T$的形式，其中$U$和$V$是标准正交矩阵，而$\Sigma$是对角线矩阵。

首先我们对矩阵$A^TA$做奇异值分解，得到$A^TA=V\Lambda V^T$，因此我们直接得到了一个标准正交矩阵。接下来我们证明两个$V$中的正交向量列$v_i$和$v_j$在$A$的线性变换下依旧正交。

$$
(Av_i)^T(Av_j)=v_i^T(A^TAv_j)=v_i^T\lambda v_j=\lambda v_i^Tv_j=0
$$

因此我们得到了正交矩阵$AV$。但是这里$AV$不一定是标准化的。我们可以将$AV$右乘一个对角矩阵帮助其标准化：

$$
AV\Sigma^{-1}=U\\
\Rightarrow AV=U\Sigma\\
\Rightarrow A=U\Sigma V^-1 \\
\Rightarrow A=U\Sigma V^T
$$

# AGC006C

**题意**

[https://atcoder.jp/contests/agc006/tasks/agc006_c](https://atcoder.jp/contests/agc006/tasks/agc006_c)

**题解**

考虑$a_i$发生变化，容易推出发生变化后的期望值为：
$$
E[a_i']=E[a_{i+1}]+E[a_{i-1}]-E[a_i]
$$
。

之后我们来理解形如
$$
b'=a+c-b
$$
等式的几何含义。

考虑一个数轴，我们在$a$、$b$、$c$、$b'$处各放了一个顶点，记作$A$，$B$，$C$，$B'$。

可以发现：
$$
b'-a=c-b\\
c-b'=b-a
$$

这意味着操作$a_i$会导致$a_i$到$a_{i-1}$以及$a_{i+1}$到$a_i$的距离交换了。

因此假如我们维护的不是每个顶点的具体位置，而是形如$d_i=a_i-a_{i-1}$的差量，那么一次变换可以简单的表示为
$$
swap(d_i,d_{i+1})
$$
。因此我们需要做的实际上是维护一个置换，之后对置换进行k次幂运算，最后重新排列d，进而计算出最终位置。
