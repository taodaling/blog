---
categories: algorithm
layout: post
---

- table
{:toc}
# AGC006C

**题意**

[https://atcoder.jp/contests/agc006/tasks/agc006_c](https://atcoder.jp/contests/agc006/tasks/agc006_c)

**题解**

考虑$a_i$发生变化，容易推出发生变化后的期望值为：
$$
E[a_i']=E[a_{i+1}]+E[a_{i-1}]-E[a_i]
$$
。

之后我们来理解形如
$$
b'=a+c-b
$$
等式的几何含义。

考虑一个数轴，我们在$a$、$b$、$c$、$b'$处各放了一个顶点，记作$A$，$B$，$C$，$B'$。

可以发现：
$$
b'-a=c-b\\
c-b'=b-a
$$

这意味着操作$a_i$会导致$a_i$到$a_{i-1}$以及$a_{i+1}$到$a_i$的距离交换了。

因此假如我们维护的不是每个顶点的具体位置，而是形如$d_i=a_i-a_{i-1}$的差量，那么一次变换可以简单的表示为
$$
swap(d_i,d_{i+1})
$$
。因此我们需要做的实际上是维护一个置换，之后对置换进行k次幂运算，最后重新排列d，进而计算出最终位置。