---
categories: algorithm
layout: post
---

- table
{:toc}
# 拉格朗日定理

拉格朗日定理：对于任意有限群$G$以及其某个子群$H$，都有
$$
|G|
$$
能被
$$
|H|
$$
整除。

证明：

当$G=H$时，定理显然成立，下面考虑$G\neq H$，此时有$\|H\|<\|G\|$。

考虑$H$在$G$中的补集中的任意元素$x_1$，我们构建$H$的左陪集：

$$
x_1H=\{x_1*h|h\in H\}
$$
。

下面我们证明$H$的这些左陪集与$H$的交集为空，假设存在交集，即：

$$
h_i=x_1*h_j
$$
，那么我们可以直接推出：
$$
x_1=h_i*h_j^{-1}\in H
$$
，而这与$x_1$不属于$H$的前提相悖，因此证明完成。

如果$H$与$xH$的并集不等于$G$，那么就存在额外的元素$x_2$，落在$H$和$xH$之外。于是我们继续构建$H$的左陪集$x_2H$。

重复这个流程，直到得到左陪集与$H$的并集等于$G$为止。假设这时候我们得到的左陪集为$x_1H,x_2H,\ldots, x_kH$。

下面我们证明这些左陪集也是互不相交的，假设$x_iH$与$x_jH$（$i < j$）交集非空，那么有：
$$
x_ih_i=x_jh_j\Rightarrow x_j=x_ih_ih_j^{- 1}\Rightarrow x_j\in x_iH
$$

，这与我们之前的
$$
x_j \notin x_iH
$$
前提相悖，因此证明成立。

可以发现这k个左陪集与$H$都拥有$\|H\|$个元素，且互不相交，且并为$G$。因此可以得出：
$$
(k+1)|H|=|G|
$$
，因此$\|H\|$能够整除$\|G\|$，命题成立。

# $A^TA$是非奇异矩阵的充分必要条件

$A^TA$是非奇异矩阵，当且仅当A的列向量线性无关。

证明:

由于两个矩阵的乘积的秩小于等于任意一个乘元矩阵的秩，因此必要性易得。

下面证明充分性，考虑$A^TA$的零空间中的向量$x$，有

$$
A^TAx=0\\
\Rightarrow x^TA^TAx=0\\
\Rightarrow (Ax)^T(Ax)=0\\
\Rightarrow ||Ax||^2=0\\
\Rightarrow x\in N(A)
$$

即我们推出$x$属于$A$的零空间，而$A$的零空间的维度为0，因此$A^TA$的零空间的维度也是0，因此$A^TA$列线性无关。证明完毕。


# AGC006C

**题意**

[https://atcoder.jp/contests/agc006/tasks/agc006_c](https://atcoder.jp/contests/agc006/tasks/agc006_c)

**题解**

考虑$a_i$发生变化，容易推出发生变化后的期望值为：
$$
E[a_i']=E[a_{i+1}]+E[a_{i-1}]-E[a_i]
$$
。

之后我们来理解形如
$$
b'=a+c-b
$$
等式的几何含义。

考虑一个数轴，我们在$a$、$b$、$c$、$b'$处各放了一个顶点，记作$A$，$B$，$C$，$B'$。

可以发现：
$$
b'-a=c-b\\
c-b'=b-a
$$

这意味着操作$a_i$会导致$a_i$到$a_{i-1}$以及$a_{i+1}$到$a_i$的距离交换了。

因此假如我们维护的不是每个顶点的具体位置，而是形如$d_i=a_i-a_{i-1}$的差量，那么一次变换可以简单的表示为
$$
swap(d_i,d_{i+1})
$$
。因此我们需要做的实际上是维护一个置换，之后对置换进行k次幂运算，最后重新排列d，进而计算出最终位置。
