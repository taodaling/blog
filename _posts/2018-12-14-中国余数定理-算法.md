---
categories: algorithm
layout: post
---

# 中国余数定理

假设存在k个互质的整数，m[1],m[2],...,m[k]，记m=m[1]\*m[2]\*...\*m[k]。

对于任意整数x<m，记：

x[i]=x mod m[i]

我们定义函数f，使得f(x)=(x[1],x[2],...x[k])。

**命题1：f是定义域为[0,m)，值域为[0,m[1])x[0,m[2])x...x[0,m[k])的双射函数**

证明：

记n[i]=m/m[i]

由于n[i]与m[i]互质，因此，存在r[i]使得r[i]*n[i]=1(mod m[i])。(利用扩展欧几里得公式可以得到)

记c[i]=r[i]*n[i]

很显然对于任意j!=i，c[i]=0 (mod m[j])

而对于j=i，有c[i]=1(mod m[i])

因此c[i]=(0,...,0,1,0,...,0)，其中仅第i位为1，其它位均为0

我们实际上找打了一组基c[1],...,c[k]

而a[1]\*c[1]+...+a[k]\*a[k]=(a[1],a[2],...,a[k])

因此我们可以从任一值域中的值还原出定义域上的值，因此f是满射

由于定义域和值域的大小均为m，因此f一定是双射



**命题2：若f(x)=(a,a,...,a)，那么我们必定有x=a(mod m)**

证明：

首先f(a)=(a,...,a)，且f是双射，因此结果显然。