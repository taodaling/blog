---
categories: algorithm
layout: post
---

- table
{:toc}

# 周期

对于值域为自然数的函数$f$，若对于某个非$0$自然数$t$，始终满足
$$
f(x+t)=f(x)
$$
，那么称$t$是函数$f$的周期。

# 翻转序列的周期

对于序列s，将s顺序颠倒后得到序列s'。

假设序列s的周期为t，那么有等式：
$$
f_s(x+t)=f_s(x)\Rightarrow f_s(x)=f_s(x-t)\Rightarrow f_{s'}(n-x)=f_{s'}(n-x+t)
$$
因此t也一定是s的周期。借助对称性，我们可以断言s的周期集合和s'的周期集合相同。



# 多个周期

如果函数有多个周期$t_1,t_2,\ldots, t_k$。

我们先观察$t_1,t_2$，不妨设$t_1< t_2$。那么我们可以断定$t_2-t_1$也是函数的周期。

考虑到欧几里得原理可以仅借助减法得到两个数的最大公约数，因此，$gcd(t_1,t_2)$也是函数的周期。

现在考虑$k$个不同的周期，那么必定有
$$
t_1=gcd(t_1,t_2,\ldots,t_k)
$$
成立。即每个周期都应该是函数的最小周期的倍数。

# 字符串最小周期

字符串的最小周期可以通过KMP算法找到。

我们定义$next(i)$表示字符串
$$
s[1..i]
$$
的所有后缀组成的集合Suf和所有前缀组成的集合Pre的交集中长度最长的元素的长度。那么可以证明
$$
|s|-next(|s|)
$$
就是字符串的最小周期。

# 字符串的完整周期

称长度为n的字符串s的一个周期t是完整的，当且仅当n能被t整除。

由于完整周期也是周期，因此假如字符串s存在完整周期，那么考虑字符串s的最小周期一定能被这个完整周期所整除。故字符串的最小周期是完整周期是字符串有完整周期的充分必要条件，同时该最小周期也一定是最小的完整周期。

字符串的最小周期可以通过KMP算法得到，因此，完整周期也可以同样通过KMP算法得到。

# 正逆周期

**考虑一个长度为n的二进制01序列s，我们将其逆（将序列每个元素取反，0变成1，1变成0）记作s'，我们称ss'的周期为s的正逆周期，问s的最小正逆周期是多少。**

很显然2n一定是s的一个正逆周期，那么是否有更小的正逆周期呢。

记t为s和s'的最小周期（两者的最小周期显然相同），而考虑s的最小正逆周期t'，如果$t'<2n$，那么我们可以断定$t'<n$，即t'也一定是s的一个周期。这可以得出一个重要的性质，t'能被t整除，同时t一定也是正逆周期，故$t'=t$。

整理一下得出，如果s有小于2n的非平凡正逆周期，那么该正逆周期一定等于s的最小周期。

**下面考虑另外一个问题，长度为n的二进制序列中，有多少序列的最小周期正好等于t**

在s的最小正逆周期是非平凡（不等于2n）的前提下，如果n能被t整除，那么就会出现$s'=s$的情况，这是不可能的，因此可以推出t一定不是s的完整周期。

现在考虑$r=n\mod t$。如果$r=t/2$，我们会得到一个可行的方案，只要确定了s的前$r$个元素，通过交替序列即可得到一个拥有正逆周期t的s。（注意这里不一定是最小的）

要计算最小，我们需要使用容斥原理来解决。

