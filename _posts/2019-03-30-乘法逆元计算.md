---
categories: algorithm
layout: post
---

# 正文

$x$的乘法逆元是指这样的一个数$y$，满足$x\cdot y=1$。如果乘法满足结合律，那么$x$的乘法逆元是唯一的，假设$z$也是$x$的乘法逆元，那么$y=y(xz)=(yx)z=z$。

一般乘法逆元在素数的剩余类域中比较有用，因此下面仅讨论在模素数$p$意义下的乘法逆元。

如果仅想获得少数数的乘法逆元，可以利用费马小定理，由于$x^{p-1}=1$，因此乘法逆元为$x^{p-2}$。这里幂运算可以利用快速幂运算的技巧，因此时间复杂度为$O(log_2p)$。

如果不能保证p是素数，但是能保证x与p互质，那么可以利用扩展欧几里得算法，获得公式


$$
ax+bp=1\rightarrow ax=1(mod\phantom{1}p)
$$



而扩展欧几里得算法的时间复杂度为$O(\log_2p)$。

如果想要获得$1,2,\ldots,n$的乘法逆元，如果用上面的算法，需要$O(n\log_2p)$的时间复杂度。但是利用一些简单的性质，我们就可以得到乘法逆元的递推公式，将时间复杂度优化到$O(n)$。设$k=\lfloor{p/x}\rfloor$，记$r=p(mod x)$，可以得出$p=kx+r$。


$$
p=kx+r\\
\rightarrow kx+r=0(mod\phantom{1}x)\\
\rightarrow r^{-1}x+k^{-1}=0(mod\phantom{1}x)\\
\rightarrow r^{-1}+x^{-1}k^{-1}=0(mod\phantom{1}x)\\
\rightarrow x^{-1}=-kr^{-1}\\
$$

由于$r<x$，因此可以通过已知逆元$r^{-1}$推导出未知逆元$x^{-1}$。

# 参考文献

\[1\] [乘法逆元的计算](https://oi.men.ci/mul-inverse/)

