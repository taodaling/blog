---
categories: algorithm
layout: post
---

- Table
{:toc}
# 快速数论变换

了解快速傅里叶变换的人应该知道，快速傅里叶变换之所以能成立源于对任意正整数n，存在这样的一个单位根$w(n)$，满足四个条件：

1. $w(n)^0,w(n)^1, \ldots, w(n)^{n-1}$各不相同
2. $w(n)^n = 1$
3. $w(dn)^{dk}=w(n)^k$。
4. $w(2n,n)=-1$

在快速傅里叶变换中，我们选取$w(n)=e^{(2\pi /n)i}$作为单位根。

快速傅里叶变换会存在一定的精度损失问题，我们可以使用快速数论变换来替代。但是快速数论变换实际上还是沿用了快速傅里叶变换的整体框架，只是替换了单位根。我们需要找一个素数p，并找到它的一个原根g。可以发现当我们取w(n)=g^{\frac{p-1}{n}}时，可以满足上面所有条件。不是所有p都适合用于快速数论变换，我们需要找一个比较特殊的p，使得$n\|p-1$。由于一般是的幂次，因此我们希望。由于n一般是2的幂次，因此我们希望p-1$包含尽可能多的因子2，下面介绍两个常用的选择：


$$
998244353=2^{23}\cdot17 \cdot 7 +1\\
1004535809=2^{21}\cdot 479
$$


剩下的和快速傅里叶变换没有什么区别，直接套用就好了。