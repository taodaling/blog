---
categories: algorithm
layout: notebook
---

- Table
{:toc}

# 基本流程

将训练数据(training set)喂给某个学习算法(learning algorithm)，之后算法计算出一个假说(hypothesis)，$h$。之后对于给定的输入$x$，假说会估算出来结果$h(x)$。

现在的问题是该如何表示一个假说$h$。

我们记录$n$为输入向量的长度，$m$为输出向量的长度，$k$为训练集的大小。因此训练集可以表示为$(x^{(1)},y^({1})),\ldots,(x^{(k)},y^{(k)})$。其中每个元素$(x^{(i)},y^{(i)})$叫做一个训练样本。

如果我们有多个假说，我们还需要设计一套误差计算的函数$D$，$h$在第$i$个样本上的误差为$D(h(x^{(i)})-y^{(i)})$。而在所有训练集上的总误差一般为$J(h)=\sum_{i=1}^kD(h(x^{(i)})-y^{(i)})$。这样我们就能比较两个不同的假说的优劣了。

# 线性回归(linear regression)

在线性回归中，假说$h(x)=ax+b$，即一个仿射函数。

举个例子。通过房子的信息，我们要估算房子的价格。其中$x$是一个长度为$2$的列向量$(size\_of\_house, number\_of\_bedrooms)$，而$a$则是一个$1\times 2$的矩阵，$b$是一个实数。为了让公式更加紧凑，我们可以将$x$增加一个维度，增加的维度的值始终是一个守护值$1$，这样我们就可以将假说重写为$h(x)=Ax$，一个线性函数。

线性回归算法的目标就是为你选择合适的$A$来产生尽可能精确的结果。

线性回归中，误差函数一般为$D(v)=\frac{1}{2}\|v\|^2$，即离原点的距离的平方。

## 梯度下降(gradient descent)

梯度下降是用来寻找假说中系数$A$的算法。

我们可以从任意一个随机矩阵$A$出发。之后让

$$
a_{i,j}:=a_{i,j}-\frac{\partial J}{\partial a_{i,j}}(A)\cdot J(A)\cdot \alpha$$

其中$\alpha$是一个常量，称为学习率（learning rate)，决定了学习的速率。

下面推导一下偏导数：


$$
\begin{aligned}
\frac{\partial J}{\partial a_{i,j}}(A)&=\frac{\partial}{\partial a_{i,j}}\sum_{t=1}^kD(Ax^{(t)}-y^{(t)})\\
&=\frac{1}{2}\frac{\partial}{\partial a_{i,j}}\sum_{t=1}^k(A_ix^{(t)}-y^{(t)}_i)^2\\
&=\frac{1}{2}\frac{\partial}{\partial a_{i,j}}\sum_{t=1}^k(\sum_{r}a_{i,r}x^{(t)}_r-y^{(t)}_i)^2\\
&=\frac{1}{2}\sum_{t=1}^k 2(\sum_{r}a_{i,r}x^{(t)}_r-y^{(t)}_i)x^{(t)}_j\\
&=\sum_{t=1}^k (\sum_{r}a_{i,r}x^{(t)}_r-y^{(t)}_i)x^{(t)}_j
\end{aligned}
$$

在线性回归模型中，只有唯一的极小值点，因此不会陷入局部最小值的情况。